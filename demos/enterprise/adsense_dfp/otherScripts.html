<!--------------------------------------------------------------------------------------------------------->
<!-- example DFP code - generated by the DFP dashboard -->
<script type='text/javascript'>
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    (function() {
        var gads = document.createElement('script');
        gads.async = true;
        gads.type = 'text/javascript';
        var useSSL = 'https:' == document.location.protocol;
        gads.src = (useSSL ? 'https:' : 'http:') +
                '//www.googletagservices.com/tag/js/gpt.js';
        var node = document.getElementsByTagName('script')[0];
        node.parentNode.insertBefore(gads, node);
    })();
</script>

<script type='text/javascript'>

    // for this demo, this has been pushed into the Janrain event hook handlers:

    //        googletag.cmd.push(function() {
    //            googletag.defineSlot('/118395914/test_ad_unit_1', [468, 60], 'div-gpt-ad-1393954517156-0')
    //                    .addService(googletag.pubads())
    //            googletag.pubads().enableSingleRequest();
    //            googletag.enableServices();
    //        });

</script>
<!--------------------------------------------------------------------------------------------------------->

<!-- Add your own Capture event handlers. To see the full list, run the following in the browser console: janrain.events  -->
<script type="text/javascript">

    function displayDFPAd(userData) {

        /*
         In this demo, we are not going to actually pull demographic data from the user and add to targeting,
         instead we will just show some (commented) ideas for how that can be done.

         The reason for doing it this way: if you are passing profile which originated from an Identity Provider
         into an ad network (such as AdSense), you need to look very carefully at the Terms of Service from both the
         Identity Provider and the Ad Network about how data can be used. Some providers, such as Google and
         Facebook, expressly forbid the transfer of user data to an Ad Network.

         So, we recommend that you review the TOS for each provider you choose to use, and then consider this
         demo as a reference implementation only which you could potentially use to build a DFP integration. One
         thing to consider would be adding custom fields to your "almost done" and "edit profile" forms, where a
         user can self-declare demographic data which you could potentially then use to use in ad targeting. Again,
         be sure to consult with your TOS from IDPs and ad networks, before deciding how to use customer data.
         */

        // This is how one might try to pull gender from the Janrain userdata object:
        var gender = "unknown";
        try {
            gender = userData.gender;
        }
        catch (e) {
            // handle errors...
            console.log (e);
        }

        // slightly modified version of the boilerplate code from the DFP dashboard:
        googletag.cmd.push(function() {
            googletag.defineSlot('/118395914/test_ad_unit_1', [468, 60], 'div-gpt-ad-1393954517156-0')
                    .addService(googletag.pubads());

            // This would be an example of how to simply add "gender" to the ad targeting.
            // Again, we are not including this in our live demo as gender is coming directly
            // from the IDPs and we can not violate their TOS. See above note.

            // (...this line would attach directly onto the .addService() call above...)
            // .setTargeting("gender", gender);


            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });

        // now display the ad:
        googletag.cmd.push(function() { googletag.display('div-gpt-ad-1393954517156-0'); });

    }
</script>
